<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>lllki</title>
    <description>Lirian Su&#39;s Blog</description>
    <link>http://www.cloudisdream.com/</link>
    <atom:link href="http://www.cloudisdream.com/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 23 Sep 2015 10:17:09 +0800</pubDate>
    <lastBuildDate>Wed, 23 Sep 2015 10:17:09 +0800</lastBuildDate>
    <generator>Jekyll v2.2.0</generator>
    
      <item>
        <title>Vagrant-up遇到mount no device的解决方案</title>
        <description>&lt;p&gt;今天跑&lt;code&gt;vagrant up&lt;/code&gt;的时候遇到了这个问题：&lt;/p&gt;

&lt;p&gt;```
    ==&amp;gt; cvc-tools: Machine booted and ready!
    ==&amp;gt; cvc-tools: Checking for guest additions in VM…
    ==&amp;gt; cvc-tools: Configuring and enabling network interfaces…
    ==&amp;gt; cvc-tools: Mounting shared folders…
        cvc-tools: /work =&amp;gt; D:/work/
    Failed to mount folders in Linux guest. This is usually because
    the “vboxsf” file system is not available. Please verify that
    the guest additions are properly installed in the guest and
    can work properly. The command attempted was:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount -t vboxsf -o uid=`id -u devel`,gid=`getent group devel | cut -d:
-f3` work /work
mount -t vboxsf -o uid=`id -u devel`,gid=`id -g devel` work /work

The error output from the last command was:

/sbin/mount.vboxsf: mounting failed with the error: No such device ```
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;查看了 https://github.com/mitchellh/vagrant/issues/1657
以后，明白这是&lt;code&gt;yum update&lt;/code&gt;更新了内核，但是没有更新VirtualBox的连接的问题。
于是重新添加一下VBox：&lt;/p&gt;

&lt;p&gt;```
    [lirian@localhost ~]$ sudo /etc/init.d/vboxadd setup
    Removing existing VirtualBox non-DKMS kernel modules       [  OK  ]
    Building the VirtualBox Guest Additions kernel modules
    The headers for the current running kernel were not found. If the
    following
    module compilation fails then this could be the reason.
    The missing package can be probably installed with
    yum install kernel-devel-2.6.18-404.el5&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Building the main Guest Additions module                   [FAILED]
(Look at /var/log/vboxadd-install.log to find out what went wrong)
Doing non-kernel setup of the Guest Additions              [  OK  ] ```
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;根据以上信息，得知现在在跑的内核开发包缺失，于是再跑一下：
&lt;code&gt;yum install kernel-devel-2.6.18-404.el5&lt;/code&gt;
之后再vagrant up或者手动mount就可以解决问题了。&lt;/p&gt;

&lt;p&gt;总结：vagrant up遇到mount error: no such device可以通过以下脚本解决：&lt;/p&gt;

&lt;p&gt;&lt;code&gt;
    yum install  kernel-devel-2.6.18-404.el5
    /etc/init.d/vboxadd setup
    mount -t vboxsf -o uid=`id -u devel`,gid=`id -g devel` work /work
&lt;/code&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 15 May 2015 18:29:05 +0800</pubDate>
        <link>http://www.cloudisdream.com/vagrant-up-but-mount-no-device-zh</link>
        <guid isPermaLink="true">http://www.cloudisdream.com/vagrant-up-but-mount-no-device-zh</guid>
        
        
      </item>
    
      <item>
        <title>Solution for vagrant-up error: mount no device</title>
        <description>&lt;p&gt;Solution for vagrant up failure with mount no such device error:&lt;/p&gt;

&lt;p&gt;Today I encounter a problem running &lt;code&gt;vagrant up&lt;/code&gt;：&lt;/p&gt;

&lt;p&gt;```
    ==&amp;gt; cvc-tools: Machine booted and ready!
    ==&amp;gt; cvc-tools: Checking for guest additions in VM…
    ==&amp;gt; cvc-tools: Configuring and enabling network interfaces…
    ==&amp;gt; cvc-tools: Mounting shared folders…
        cvc-tools: /work =&amp;gt; D:/work/
    Failed to mount folders in Linux guest. This is usually because
    the “vboxsf” file system is not available. Please verify that
    the guest additions are properly installed in the guest and
    can work properly. The command attempted was:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount -t vboxsf -o uid=`id -u devel`,gid=`getent group devel | cut -d:
-f3` work /work
mount -t vboxsf -o uid=`id -u devel`,gid=`id -g devel` work /work

The error output from the last command was:

/sbin/mount.vboxsf: mounting failed with the error: No such device ```
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Refer to https://github.com/mitchellh/vagrant/issues/1657 
&lt;em&gt;This is usually a result of the guest’s package manager upgrading the
kernel without rebuilding the VirtualBox Guest Additions&lt;/em&gt; by lenciel. So
we run vboxadd accordingly:&lt;/p&gt;

&lt;p&gt;```
    [lirian@localhost ~]$ sudo /etc/init.d/vboxadd setup
    Removing existing VirtualBox non-DKMS kernel modules       [  OK  ]
    Building the VirtualBox Guest Additions kernel modules
    The headers for the current running kernel were not found. If the
    following
    module compilation fails then this could be the reason.
    The missing package can be probably installed with
    yum install kernel-devel-2.6.18-404.el5&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Building the main Guest Additions module                   [FAILED]
(Look at /var/log/vboxadd-install.log to find out what went wrong)
Doing non-kernel setup of the Guest Additions              [  OK  ] ```
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From the message we can know current running kernel were not found. So
we run:&lt;code&gt;yum install kernel-devel-2.6.18-404.el5&lt;/code&gt;
After all, we can run &lt;code&gt;vagrant up&lt;/code&gt; or mount the directory manually.&lt;/p&gt;
</description>
        <pubDate>Fri, 15 May 2015 18:29:05 +0800</pubDate>
        <link>http://www.cloudisdream.com/vagrant-up-but-mount-no-device-en</link>
        <guid isPermaLink="true">http://www.cloudisdream.com/vagrant-up-but-mount-no-device-en</guid>
        
        
      </item>
    
      <item>
        <title>用Openpyxl做两个Excel文件的比对</title>
        <description>&lt;h1 id=&quot;openpyxlexcel&quot;&gt;用Openpyxl做两个Excel文件的比对&lt;/h1&gt;

&lt;h2 id=&quot;section&quot;&gt;起因&lt;/h2&gt;

&lt;p&gt;最近老是要做比对Excel报表的工作，于是想写一个Python的小脚本来做这个工作。
关于Python的Excel处理，以前只用过xlrd库，处理的是Office03的.xls文件。
这次写小工具的同时也是学习一下新的东西。&lt;/p&gt;

&lt;h2 id=&quot;section-1&quot;&gt;准备工作&lt;/h2&gt;

&lt;p&gt;由于本次要比对的报表是Office07的.xlsx文件，上网查了一下Python怎么做比较合适。
看了几篇心得以后，敲定用Openpyxl（参考如下链接：）&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;http://www.gocalf.com/blog/python-read-write-excel.html&quot;&gt;Python处理Excel的四个工具&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;于是接下来是装Openpyxl，到官网上按照流程装了一发：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://pythonhosted.org/openpyxl/&quot;&gt;A Python Library: Openpyxl&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;由于源码是到BitBucket上拖下来的，所以顺便还装了SourceTree。
据说SourceTree还有Git的相关功能，下次可以体验一下。&lt;/p&gt;

&lt;h2 id=&quot;openpyxl&quot;&gt;使用Openpyxl&lt;/h2&gt;

&lt;p&gt;Openpyxl装好以后直接import就能用啦：&lt;/p&gt;

&lt;p&gt;&lt;code&gt;python
from openpyxl import *
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Openpyxl还提供了一个非常棒的教程~~（有点过于简单~~&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://pythonhosted.org/openpyxl/tutorial.html&quot;&gt;Openpyxl Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Openpyxl还有个弊端就是文档不怎么详细，只能去翻源码。&lt;/p&gt;

&lt;h2 id=&quot;section-2&quot;&gt;最终代码&lt;/h2&gt;

&lt;p&gt;可以到我写的PythonScripts里找到我写的版本：&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/LKI/PythonScripts/tree/master/ExcelComparer&quot;&gt;PythonScripts - ExcelComparer&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Thu, 28 Aug 2014 18:31:08 +0800</pubDate>
        <link>http://www.cloudisdream.com/compare-excel-using-openpyxl/</link>
        <guid isPermaLink="true">http://www.cloudisdream.com/compare-excel-using-openpyxl/</guid>
        
        
      </item>
    
  </channel>
</rss>
